(window.MIP=window.MIP||[]).push({name:"mip-audio",func:function(){define("mip-audio/mip-audio",["require","zepto","customElement"],function(e){function t(){var e=this.element;if(!e.isRender){e.isRender=!0;var t=e.getAttribute("src")||"";if(""!=t){new i({url:t,layout:e}).init()}}}function i(e){this.url=e.url,this.layout=e.layout,this.allstoptime,this.viodevalue=2,this.canplaythrough=!0,this.timeupdate=!0,this.dragboolen=!0,this.stopbtn=!1}var n=e("zepto"),a=e("customElement").create();return i.prototype={init:function(){var e=n(this.layout),t=this.creatdom();n(this.layout).append(t),this.audio=e.find("audio")[0],this.gettimelen(),this.playaudioEvent(),this.endaudioEvent()},creatdom:function(){return"<div class='mip-audio'><div class='mip-audio-playbtn mip-audio-voice-play'></div><div class='mip-audiao-progress'><div class='mip-audiao-progressshow'></div><div class='mip-audiao-progresbtn mip-audiao-progres-bar'><div class='mip-audiao-progresbtn-slide'></div></div></div><div class='mip-audio-timeshow'><p>00:00</p></div><audio src = "+this.url+"></audio>"},playaudioEvent:function(){var e=this;n(this.layout).on("click",".mip-audio-playbtn",function(){e.playtrgger()})},endaudioEvent:function(){var e=this,t=n(this.layout);n(e.audio).on("ended",function(){t.find(".mip-audio-voice-stop").removeClass("mip-audio-voice-stop").addClass("mip-audio-voice-play")})},viodecontrol:function(){var e=n(this.layout),t=this;e.on("click",".mip-audio-voice",function(){if(0==t.viodevalue)t.viodevalue=1,t.audio.volume=.5,t.audio.muted=!1,e.find(".mip-audio-voice0").removeClass("mip-audio-voice1").addClass("mip-audio-voice1"),e.find(".mip-audiao-progress-viode .mip-audiao-progresbtn").css("left","20%");else if(1==t.viodevalue)t.viodevalue=2,t.audio.volume=1,t.audio.muted=!1,e.find(".mip-audio-voice1").removeClass("mip-audio-voice1").addClass("mip-audio-voice2"),e.find(".mip-audiao-progress-viode .mip-audiao-progresbtn").css("left","52%");else t.viodevalue=0,t.audio.volume=0,t.audio.muted=!0,e.find(".mip-audio-voice2").removeClass("mip-audio-voice2").addClass("mip-audio-voice0"),e.find(".mip-audiao-progress-viode .mip-audiao-progresbtn").css("left","0%")})},playtrgger:function(){var e=n(this.layout);if(this.audio.paused){if(this.audio.play(),e.find(".mip-audio-voice-play").removeClass("mip-audio-voice-play").addClass("mip-audio-voice-stop"),this.gettimelen(),this.progressshow(),!this.dragboolen)return;this.drag(),this.dragboolen=!1}else this.audio.pause(),clearInterval(this.allstoptime),e.find(".mip-audio-voice-stop").removeClass("mip-audio-voice-stop").addClass("mip-audio-voice-play")},progressshow:function(){var e=n(this.layout),t=this,i=e.find(".mip-audiao-progres-bar"),a=e.find(".mip-audio-timeshow p");t.allstoptime=setInterval(function(){var e=t.audio.currentTime;a.html(t.millisecondToDate(e));var n=parseInt(e)/parseInt(t.duration)*100+"%";i.css("left",n)},10)},gettimelen:function(){var e=this,t=n(this.layout);n(e.audio).on("canplay",function(){e.duration=e.audio.duration;var i=e.millisecondToDate(e.duration);if(e.canplaythrough)t.find(".mip-audio-timeshow p").html(i),e.canplaythrough=!1}),n(e.audio).on("timeupdate",function(){e.duration=e.audio.duration;var i=e.millisecondToDate(e.duration);if(e.timeupdate)t.find(".mip-audio-timeshow p").html(i),e.timeupdate=!1})},drag:function(e){var t,i=n(this.layout),a=i.find(".mip-audiao-progresbtn")[0],o=n(a).parent(".mip-audiao-progress").width(),r=this,c=!1;a.addEventListener("touchstart",function(e){if(t=e.touches[0].clientX,c=!0,clearInterval(r.allstoptime),!r.audio.paused)r.audio.pause(),r.stopbtn=!0,i.find(".mip-audio-voice-stop").removeClass("mip-audio-voice-stop").addClass("mip-audio-voice-play")}),a.addEventListener("touchmove",function(e){if(e.preventDefault(),e.stopPropagation(),c){var i=parseInt(n(a).position().left),d=e.touches[0].clientX-t,s=d+i;if(s>o)a.style.left=o+"px",r.setTimepaly(s/o);else if(s<=0)a.style.left="0px;",r.setTimepaly(parseInt(0));else a.style.left=s+"px",r.setTimepaly(s/o);t=e.touches[0].clientX}}),a.addEventListener("touchend",function(e){if(c=!1,r.stopbtn)r.audio.play(),i.find(".mip-audio-voice-play").removeClass("mip-audio-voice-play").addClass("mip-audio-voice-stop");r.progressshow()})},setTimepaly:function(e){var t=this,i=n(this.layout);t.audio.currentTime=parseInt(t.duration*e);var a=t.millisecondToDate(t.audio.currentTime);i.find(".mip-audio-timeshow p").html(a)},millisecondToDate:function(e){var t=parseInt(e),i=0,n=0;if(t>60)if(i=parseInt(t/60),t=parseInt(t%60),i>60)n=parseInt(i/60),i=parseInt(i%60);if(parseInt(t)<10)t="0"+parseInt(t);var a=""+t;if(0==i)a="00:"+a;if(i>0)a=parseInt(i)+":"+a;if(n>0)a=parseInt(n)+":"+a;return a}},a.prototype.build=t,a}),define("mip-audio",["mip-audio/mip-audio"],function(e){return e}),function(){function e(e,t){e.registerMipElement("mip-audio",t,'.mip-audio{width:300px;height:30px;background-color:#434343;border-radius:5px;margin-bottom:20px;padding:5px 15px;box-sizing:border-box;position:relative}.mip-audio-playbtn{width:20px;height:100%;display:inline-block}.mip-audiao-progress{width:187px;height:20px;display:inline-block;margin-left:10px;position:relative}.mip-audiao-progressshow{height:6px;width:100%;background-color:#818181;position:absolute;top:50%;margin-top:-3px;border:1px solid #989898;border-radius:8px}.mip-audiao-progresbtn{width:28px;height:28px;position:absolute;left:0;margin-top:-4px}.mip-audiao-progresbtn-slide{width:20px;background-color:#fff;height:12px;border-radius:8px;position:absolute;left:0;top:50%;margin-top:-5px}.mip-audio-timeshow{width:32px;height:20px;display:inline-block;margin-left:18px;position:relative}.mip-audio-timeshow p{position:absolute;top:5px;font-size:13px;color:#fff;margin:0}.mip-audio-voice-play{background:url("https://mipcache.bdstatic.com/static/static/auido/audioimg.png") no-repeat;background-size:cover}.mip-audio-voice-stop{background:url("https://mipcache.bdstatic.com/static/static/auido/audioimg.png") no-repeat;background-size:cover;background-position:-20px 0}.mip-audiao-progress-viode{width:38px}')}if(window.MIP)require(["mip-audio"],function(t){e(window.MIP,t)});else require(["mip","mip-audio"],e)}()}});