(window.MIP=window.MIP||[]).push({name:"mip-semi-fixed",func:function(){define("mip-semi-fixed/mip-semi-fixed",["require","util","viewport","customElement","fixed-element","viewer"],function(t){function e(t){var e=this.element,i=this.container,o=this.threshold,r=this.fixedClassNames,s=t.getScrollTop();if(e.offsetTop-s<=o){if(i.className.indexOf(r)<0)i.className+=r;i.setAttribute(l.STATUS_FIXED,""),n.css(i,"top",o+"px")}else i.className=i.className.replace(r,""),i.removeAttribute(l.STATUS_FIXED),n.css(i,"top","")}function i(t){var e=this.element,i=t.getScrollTop();if(e.offsetTop-i<=this.threshold)n.css(this.fixedContainer.parentNode,{display:"block"}),n.css(this.fixedContainer,{opacity:1}),n.css(this.container,{opacity:0});else n.css(this.fixedContainer.parentNode,{display:"none"}),n.css(this.fixedContainer,{opacity:0}),n.css(this.container,{opacity:1})}var n=t("util"),o=t("viewport"),r=t("customElement").create(),s=t("fixed-element"),a=t("viewer"),l={STATUS_FIXED:"mip-semi-fixed-fixedSatus",STATUS_SCROLL:"mip-semi-fixed-scrollSatus"};return r.prototype.build=function(){var t=this,r=t.element;if(!s||!s._fixedLayer||r.parentNode!==s._fixedLayer){if(t.container=r.querySelector("div[mip-semi-fixed-container]"),!t.container)return void console.error("必须有 <div mip-semi-fixed-container> 子节点");if(t.threshold=r.getAttribute("threshold")||0,t.fixedClassNames=" "+r.getAttribute("fixedClassNames"),t.container.setAttribute(l.STATUS_SCROLL,""),a.isIframed&&n.platform.isIos()){try{var c=s._fixedLayer.querySelector("#"+r.id);t.fixedContainer=c.querySelector("div[mip-semi-fixed-container]"),t.fixedContainer.className+=t.fixedClassNames,t.fixedContainer.setAttribute(l.STATUS_FIXED,""),t.fixedContainer.removeAttribute(l.STATUS_SCROLL),n.css(t.fixedContainer,{top:t.threshold+"px",opacity:0})}catch(t){console.error(t)}o.on("scroll",function(){i.call(t,o)}),document.body.addEventListener("touchmove",function(e){i.call(t,o)})}else o.on("scroll",function(){e.call(t,o)}),document.body.addEventListener("touchmove",function(i){e.call(t,o)});if(!n.platform.isIos()&&r.offsetTop-o.getScrollTop()<=t.threshold){if(t.container.className.indexOf(t.fixedClassNames)<0)t.container.className+=t.fixedClassNames;t.container.setAttribute(l.STATUS_FIXED,""),n.css(t.container,"top",t.threshold+"px")}else if(n.platform.isIos()&&a.isIframed&&r.offsetTop-o.getScrollTop()<=t.threshold)n.css(this.fixedContainer.parentNode,{display:"block"}),n.css(this.fixedContainer,{opacity:1}),n.css(this.container,{opacity:0});t.addEventAction("close",function(e){if(e.preventDefault(),n.css(r,{display:"none"}),a.isIframed)n.css(t.fixedContainer,{display:"none"})})}},r}),define("mip-semi-fixed",["mip-semi-fixed/mip-semi-fixed"],function(t){return t}),function(){function t(t,e){t.registerMipElement("mip-semi-fixed",e,".mip-fixedlayer div[mip-semi-fixed-scrollSatus],mip-semi-fixed div[mip-semi-fixed-scrollSatus]{position:absolute;z-index:1;width:100%;-webkit-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}.mip-fixedlayer mip-semi-fixed{position:fixed !important;width:100%}.mip-fixedlayer div[mip-semi-fixed-fixedSatus],mip-semi-fixed div[mip-semi-fixed-fixedSatus]{position:fixed}")}if(window.MIP)require(["mip-semi-fixed"],function(e){t(window.MIP,e)});else require(["mip","mip-semi-fixed"],t)}()}});