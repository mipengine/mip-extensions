(window.MIP=window.MIP||[]).push({name:"mip-custom",func:function(){define("mip-custom/data",["require"],function(t){function e(t){if(t.paths)for(var e in t.paths)if(t.paths.hasOwnProperty(e))t.paths[e]=t.domain+t.paths[e];return t}function i(t,e,i){return i=i?0:1,t.match(e)&&t.match(e)[i]?t.match(e)[i]:""}var n={html:/<mip-\S*>(.*)<\/mip-\S*></,script:/<script[^>]*>(.*?)<\/script>/g,style:/<style[^>]*>(.*?)<\/style>/g,innerHtml:/>([\S\s]*)<\//,customTag:/<(mip-\S+)>/,tag:"<([^\\s|>]*)",tagandAttr:/<(mip-[^>]*)>/,regHttp:/\/c\/(\S*)/,regHttps:/\/c\/s\/(\S*)/,domain:/^(http(s)?:\/\/)?[^\/]*baidu.com/};return{domain:"https://mipengine.baidu.com/",ajaxUrl:"https://mipengine.baidu.com/common?",regexs:n,params:{logid:"",query:"",title:"",originalUrl:i(location.pathname,n.regHttps)||i(location.pathname,n.regHttp)},config:{domain:"https://mipengine.baidu.com/",paths:{"js/nav":"static/js/nav","js/util":"static/js/util","js/mip-ecom/ck":"static/js/mip-ecom/ck"}},addPaths:e,subStr:i}}),define("mip-custom/url",["require","util","mip-custom/data"],function(t){function e(){var t=s.params;for(var e in t)if(t.hasOwnProperty(e))t[e]=a.hash.get(e)||t[e];var i=a&&a.hash&&a.hash.get;return t.query=i?a.hash.get("word"):"",t.logid=i?a.hash.get("lid"):"",t}function i(t){var e=null;try{var i=t.querySelector('script[type="application/json"]');if(i){if(e=JSON.parse(i.textContent),!e.accid)return void console.warn("mip-custom 缺少 accid 参数");if(!e.title)return void console.warn("mip-custom 缺少 title 参数");for(var n in e)if(e.hasOwnProperty(n))e[n]=decodeURIComponent(e[n])}}catch(t){return console.warn("json is illegal"),void console.warn(t)}return e}function n(t){var n=i(t);if(!n)return null;else return o.fn.extend(e(),n)}function r(t){var e=!0,i=s.ajaxUrl,r=n(t);if(r){for(var o in r)if(r.hasOwnProperty(o))i+=(!e?"&":"")+o+"="+r[o],e=!1;return i}}var o=t("util"),s=t("mip-custom/data"),a=window.MIP||{};return{get:r}}),define("mip-custom/log",["require"],function(t){function e(t,i,n){if(n=n||[],i=i||document,t===i||!t||!i)return n;if(t.parentNode!==i)n=e(t.parentNode,i,n);for(var r=1,o=t.previousSibling;o;){if(1===o.nodeType&&o.nodeName===t.nodeName)r++;o=o.previousSibling}if(1===t.nodeType)n.push(t.nodeName.toLowerCase()+(r>1?r:""));return n}function i(t,e){if(t){var i=e||{},n=t,r=[];for(var o in i)if(i.hasOwnProperty(o))r.push(o+"="+i[o]);if(-1===n.indexOf("?"))n+="?";else n+="&";n+=r.join("&"),i.t=+new Date;var s="MIP_CUSTOM_LOG_"+i.t,a=window[s]=new Image;a.onload=a.onerror=a.onabort=function(){a.onload=a.onerror=a.onabort=null,a=null,window[s]=null},a.src=n}}return{getXPath:e,sendLog:i}}),define("mip-custom/dom",["require","util","templates","fixed-element","mip-custom/log","mip-custom/data"],function(t){function e(t,e){return parseInt(u.css(t,e),10)||0}function i(t,e,i){i.remove();var n=document.querySelectorAll("mip-fixed").length||0,r=e.getAttribute("mip-fixed"),o=e.getAttribute("top")||null,s=e.getAttribute("bottom")||null,a=document.createElement("mip-fixed");if(e.hasAttribute("top")&&o)u.css(a,{top:o});if(e.hasAttribute("bottom")&&s)u.css(a,{bottom:s});if(a.setAttribute("type",r),a.appendChild(e),t.appendChild(a),d._fixedLayer){var c={element:a,id:"Fixed"+n};d.moveToFixedLayer(c,parseInt(n,10)),l(e,d._fixedLayer)}}function n(t,e,i,n,r){var o=r.querySelector(i+"["+n+"]")||document.createElement(i);o.setAttribute(n,"");var s=t.match(e);s&&s.forEach(function(t){var e=new RegExp("<"+i+">([\\S\\s]*)</"+i+">","g"),n=e.exec(t),r=n&&n[1]?n[1]:"";if(-1===o.innerHTML.indexOf(r))o.innerHTML+=r}),r.appendChild(o)}function r(t,e){var i=document.createElement("template");return i.setAttribute("type","mip-mustache"),i.id=e,i.innerHTML=p.subStr(t,h.innerHtml),i}function o(t,e){for(var i=document.createElement(e),n=p.subStr(t,h.tagandAttr).split(" "),o=0;o<n.length;o++){var s=n[o].split("=");if(s[0]&&s[1])i.setAttribute(s[0],s[1].replace(/"/gi,""))}var a=e+"-"+Math.random().toString(36).slice(2);return i.setAttribute("template",a),i.appendChild(r(t,a)),i}function s(t,n,r,s,a){var l=n.replace(h.script,"").replace(h.style,""),d=new RegExp(h.tag,"g").exec(l);if(!(d=d&&d[1]?d[1]:null))return null;var f=o(l,d),p=document.createElement("div");if(p.setAttribute("mip-custom-item",r),p.appendChild(f),a.appendChild(p),f.hasAttribute("mip-fixed"))i(t,f,a);return c.render(f,s,!0).then(function(i){if(i.element.innerHTML=i.html,i.element.hasAttribute("mip-fixed")&&"bottom"===i.element.parentNode.getAttribute("type")){var n=e(i.element,"height"),r=e(t,"padding-bottom");u.css(t,{"padding-bottom":r-10+n})}}),d}function a(t,e,i){for(var r=0;r<e.length;r++){var o=e[r].tplData;if(!(!o||o instanceof Array&&!o.length||o instanceof Object&&!Object.keys(o).length)){var a=e[r].tpl?decodeURIComponent(e[r].tpl):null;if(a){n(a,h.style,"style","mip-custom-css",document.head);var l=s(t,a,r,o,i);if(l)n(a,h.script,"script",l,document.body)}}}}function l(t,e){u.event.delegate(t,"a","click",function(i){if(!this.hasAttribute("mip-link")&&!/clk_info/.test(this.href)){var n=this.getAttribute("data-log-href"),r=null;if(e)r=f.getXPath(this,e),r.unshift(".mip-fixedlayer");else r=f.getXPath(this,t);var o=r?r.join("_"):"",s=n?n:this.href;if(s+=("&"===s[s.length-1]?"":"&")+"clk_info="+JSON.stringify({xpath:o}),n)f.sendLog(s,{});else this.href=s}})}var u=t("util"),c=t("templates"),d=t("fixed-element"),f=t("mip-custom/log"),p=t("mip-custom/data"),h=p.regexs;return{render:a,proxyLink:l}}),define("mip-custom/mip-custom",["viewer","fetch-jsonp","customElement","mip-custom/url","mip-custom/dom","mip-custom/data"],function(){var t=(require("viewer"),require("fetch-jsonp")),e=require("customElement").create(),i=require("mip-custom/url"),n=require("mip-custom/dom"),r=require("mip-custom/data");return e.prototype.build=function(){var e=this,o=e.element,s=(r.regexs,{}),a={};if(n.proxyLink(o),e.url=i.get(o),!e.url)return void o.remove();t(e.url,{timeout:1e4,jsonpCallback:"cb"}).then(function(t){return t.json()}).then(function(t){if(t&&t.errno)return console.error(t.errmsg),void o.remove();if(t&&r.config){var e=r.addPaths(r.config);require.config(e)}if(t&&t.data&&t.data.common)s=t.data.common;if(t&&t.data&&t.data.template)a=t.data.template;for(var i=0;i<a.length;i++){var l=a[i],u=document.createElement("div");u.setAttribute("mip-custom-container",i),o.appendChild(u),n.render(o,l,u)}},function(t){o.remove(),console.error(t)}).catch(function(t){console.warn(t)})},e}),define("mip-custom",["mip-custom/mip-custom"],function(t){return t}),function(){function t(t,e){t.registerMipElement("mip-custom",e,"mip-custom div[mip-custom-container]{padding:0 16px;margin-bottom:10px;background-color:#fff}mip-custom div[mip-custom-item]{border-bottom:1px solid #f1f1f1;padding:10px 0 8px}mip-custom div[mip-custom-item]:first-child{padding-top:16px}mip-custom div[mip-custom-item]:last-child{border-bottom:none}")}if(window.MIP)require(["mip-custom"],function(e){t(window.MIP,e)});else require(["mip","mip-custom"],t)}()}});